<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="../css/buttons.css" />
  <link rel="stylesheet" href="../css/progress.css" />
</head>
<body>

<p id="demo" onclick="myFunction()">Click me to run the code.</p>

  <script type="text/javascript" src="../src/hello.js"></script>
  <script type="text/javascript" src="../src/primes.js"></script>
  <script type="text/javascript" src="../src/timer.js"></script>
  <script type="text/javascript" src="../src/db.js"></script>

  <a class="btn-blue" onclick="dbCreateOrOpen(); return false;" href="">Open DB</a> 

  <a class="btn-blue" onclick="dbReport(); return false;" href="">Report On DB</a> 

  <a class="btn-blue" onclick="dbRead(); return false;" href="">Read DB</a> 

  <a class="btn-blue" onclick="dbClose(); return false;" href="">Close DB</a> 

  <a class="btn-orange" onclick="dbDelete(); return false;" href="">Delete DB</a>

  <p id="calc-primes-result">Result</p>

  <p id="timer-value">Timer</p>

<div class="progress-back">
  <div class="progress-bar" id="progress-bar">
    <div class="progress-label" id="progress-label"></div>
  </div>
</div>

<button onclick="startPrimesGeneration()">Start Primes Generation</button>
<button onclick="stopPrimesGeneration()">Stop Primes Generation</button>
<script>
var timerPrimesGeneration;
function startPrimesGeneration() {
  if(typeof(timerPrimesGeneration) !== "undefined") {
    return;
  }
  timerPrimesGeneration = Timer.start(ourUpdater);
}

function stopPrimesGeneration() {
  Timer.stop(timerPrimesGeneration);
  timerPrimesGeneration = undefined;
}

function ourUpdater(x) {
  var elem = document.getElementById("progress-bar");
  var percent = x.percent;
  elem.style.width = percent + '%';
  var message = x.percent + "% sec: " + x.elapsed + " rc: " + x.resultsCount + " found: " + x.cnt;
  document.getElementById("progress-label").innerHTML = message;

  dbStore(x.resultsBuffer, x.resultsCount);

//  document.getElementById("timer-value").innerHTML = x;
}
</script>


</body>
</html>

